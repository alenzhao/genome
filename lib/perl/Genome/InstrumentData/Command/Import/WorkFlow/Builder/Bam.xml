<?xml version='1.0' standalone='yes'?>
<workflow name="Import Instrument Data" executor="Workflow::Executor::SerialDeferred">
  <link fromOperation="input connector" fromProperty="working_directory" toOperation="retrieve source path from local disk" toProperty="working_directory" />
  <link fromOperation="input connector" fromProperty="source_paths" toOperation="retrieve source path from local disk" toProperty="source_path" />
  <link fromOperation="input connector" fromProperty="working_directory" toOperation="verify not imported" toProperty="working_directory" />
  <link fromOperation="retrieve source path from local disk" fromProperty="destination_path" toOperation="verify not imported" toProperty="source_path" />
  <link fromOperation="verify not imported" fromProperty="source_path" toOperation="sort bam" toProperty="bam_path" />
  <link fromOperation="sort bam" fromProperty="output_bam_path" toOperation="sanitize bam" toProperty="bam_path" />
  <link fromOperation="sanitize bam" fromProperty="output_bam_path" toOperation="split bam by read group" toProperty="bam_path" />
  <link fromOperation="input connector" fromProperty="analysis_project" toOperation="create instrument data" toProperty="analysis_project" />
  <link fromOperation="input connector" fromProperty="library" toOperation="create instrument data" toProperty="library" />
  <link fromOperation="input connector" fromProperty="instrument_data_properties" toOperation="create instrument data" toProperty="instrument_data_properties" />
  <link fromOperation="split bam by read group" fromProperty="output_bam_paths" toOperation="create instrument data" toProperty="bam_paths" />
  <link fromOperation="verify not imported" fromProperty="source_md5" toOperation="create instrument data" toProperty="source_md5s" />
  <link fromOperation="create instrument data" fromProperty="instrument_data" toOperation="output connector" toProperty="instrument_data" />
  <operation name="retrieve source path from local disk">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::RetrieveSourcePathFromLocalDisk" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="verify not imported">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::VerifyNotImported" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="sort bam">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::SortBam" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="sanitize bam">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::SanitizeBam" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="split bam by read group">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::SplitBamByReadGroup" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operation name="create instrument data" parallelBy="bam_path">
    <operationtype commandClass="Genome::InstrumentData::Command::Import::WorkFlow::CreateInstrumentData" typeClass="Workflow::OperationType::Command" />
  </operation>
  <operationtype typeClass="Workflow::OperationType::Model">
    <inputproperty>analysis_project</inputproperty>
    <inputproperty>instrument_data_properties</inputproperty>
    <inputproperty>downsample_ratio</inputproperty>
    <inputproperty>library</inputproperty>
    <inputproperty>library_name</inputproperty>
    <inputproperty>sample_name</inputproperty>
    <inputproperty>source_paths</inputproperty>
    <inputproperty>working_directory</inputproperty>
    <outputproperty>instrument_data</outputproperty>
  </operationtype>
</workflow>
