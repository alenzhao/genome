#!/usr/bin/env genome-perl

BEGIN { 
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
}

use strict;
use warnings;

use above "Genome";
use Test::More;

my $package = "Genome::Model::Tools::VerifyBamId";

use_ok($package);

my $version = "20120620";
my $vcf = "fake.vcf";
my $bam = "fake.bam";
my $out_prefix = "out";
my $max_depth = 1000;
my $precise = "--precise";
my $command = $package->create(vcf => $vcf, bam => $bam, out_prefix => $out_prefix, version => $version, max_depth => $max_depth, precise => 1);

my $exe_path = Genome::Model::Tools::VerifyBamId::_get_exe_path($version);
is($exe_path, "/usr/bin/verifyBamID$version", "exe path is found");

is($command->_get_cmd, "$exe_path --vcf $vcf --bam $bam --out $out_prefix --maxDepth $max_depth --ignoreRG --precise", "command is constructed correctly");

done_testing;
