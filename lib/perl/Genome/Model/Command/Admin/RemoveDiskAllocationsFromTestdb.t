#!/usr/bin/env genome-perl

BEGIN {
    $ENV{UR_DBI_NO_COMMIT} = 1;
    $ENV{UR_USE_DUMMY_AUTOGENERATED_IDS} = 1;
};

use strict;
use warnings;

use above 'Genome';
use Genome::Model::Command::Admin::RemoveDiskAllocationsFromTestdb;

use Test::More tests => 1;


subtest 'default values' => sub {
    plan tests => 3;

    my $expected_dbname = 'rgekrjgekrjg';
    my $expected_host = 'foo-db-host.example.com';
    my $expected_port = '8394';
    local $ENV{XGENOME_DS_GMSCHEMA_SERVER} = qq(dbname=${expected_dbname};host=${expected_host};port=${expected_port});

    is(Genome::Model::Command::Admin::RemoveDiskAllocationsFromTestdb::_parse_database_name_from_env_var(),
        $expected_dbname,
        'dbname');
    is(Genome::Model::Command::Admin::RemoveDiskAllocationsFromTestdb::_parse_database_server_from_env_var(),
        $expected_host,
        'host');
    is(Genome::Model::Command::Admin::RemoveDiskAllocationsFromTestdb::_parse_database_port_from_env_var(),
        $expected_port,
        'port');
};

